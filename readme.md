# sort_excel.py

## 概要
`sort_excel.py`は、Excelファイルの「受諾確認票」シートを読み込み、以下の処理を行うPythonスクリプトです：
1. 「融資実行日」で並び替えたデータを出力。
2. 「金消日・面談日」で並び替えたデータを出力。
3. 上記2つのデータを統合し、日付ごとに分けたシートを含むExcelファイルを作成。

このスクリプトは、Windows 10およびWindows 11環境で動作します。

---

## 必要条件
- **OS**: Windows 10 または Windows 11
- **Python**: 3.8以上
- **ライブラリ**: `pandas`, `openpyxl`

---

## インストール手順

### 1. Pythonのインストール
1. [Python公式サイト](https://www.python.org/)にアクセスし、最新のPythonをダウンロードします。
[windowsはこちら](https://www.python.org/downloads/windows/)
![alt text](image.png)
2. インストーラーを実行し、以下の設定を確認してください：
   - 「Add Python to PATH」にチェックを入れる。
   - 「Customize installation」を選択し、「pip」をインストールするオプションを有効にする。
3. インストールが完了したら、コマンドプロンプトを開き、以下のコマンドでインストールを確認します：
   ```cmd
   python --version
   pip --version
   ```

### 2. 必要なライブラリのインストール
以下のコマンドを実行して、必要なライブラリをインストールします：
```cmd
pip install pandas openpyxl
```

---

## スクリプトの導入方法

### 1. リポジトリのダウンロード
1. GitHubリポジトリのページにアクセスします。
2. 「Code」ボタンをクリックし、「Download ZIP」を選択してリポジトリをダウンロードします。
3. ダウンロードしたZIPファイルを解凍します。

### 2. スクリプトの実行
1. 解凍したフォルダ内に`sort_excel.py`があることを確認します。
2. コマンドプロンプトを開き、スクリプトがあるフォルダに移動します：
   ```cmd
   cd <解凍したフォルダのパス>
   ```
3. スクリプトを実行します：
   ```cmd
   python sort_excel.py <Excelファイルのパス>
   ```
   例：
   ```cmd
   python sort_excel.py C:\Users\YourName\Documents\input.xlsx
   ```

---

## バッチファイルの利用方法
スクリプトを簡単に実行するために、`sort_excel.bat`を使用できます。

### 1. バッチファイルの配置
`sort_excel.bat`を`sort_excel.py`と同じフォルダに配置します。

### 2. 実行方法
やり方Ⅰ
1. バッチファイルに基になるエクセルファイルをドラックアンドドロップします．

2. 実行後．出力され終了します．


やり方Ⅱ
1. バッチファイルを右クリックして「管理者として実行」するか、コマンドプロンプトから以下のように実行します：
   ```cmd
   sort_excel.bat <Excelファイルのパス>
   ```
   例：
   ```cmd
   sort_excel.bat C:\Users\YourName\Documents\input.xlsx
   ```

2. 実行後、結果を確認するためにコマンドプロンプトが一時停止します。

---

## 出力結果
スクリプトを実行すると、以下の内容を含む`sorted_combined.xlsx`というファイルが生成されます：
1. **`sorted_by_融資実行日`シート**: 融資実行日で並び替えたデータ。
2. **`sorted_by_金消日・面談日`シート**: 金消日・面談日で並び替えたデータ。
3. **`統合データ`シート**: 統合されたデータ。
4. **各日付ごとのシート**: 統合データを日付ごとに分けたシート。

---

## 注意事項
- 入力ファイルは、必ず「受諾確認票」という名前のシートを含む必要があります。
- シート名に使用できない文字（例：`/`）は、自動的に`-`に置き換えられます。
- 入力ファイルの形式はExcel（`.xlsx`）である必要があります。

---

## トラブルシューティング

### 1. `python`コマンドが認識されない
- Pythonが正しくインストールされていない可能性があります。「Add Python to PATH」にチェックを入れて再インストールしてください。

### 2. ライブラリが見つからないエラー
- 必要なライブラリがインストールされていない場合、以下のコマンドを実行してください：
  ```cmd
  pip install pandas openpyxl
  ```

### 3. その他のエラー
- エラーメッセージを確認し、入力ファイルの形式や内容を確認してください。

---

## ライセンス
このスクリプトはMITライセンスのもとで公開されています。
